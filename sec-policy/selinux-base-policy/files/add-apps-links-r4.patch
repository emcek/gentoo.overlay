--- refpolicy.orig/policy/modules/apps/links.te	1970-01-01 01:00:00.000000000 +0100
+++ refpolicy/policy/modules/apps/links.te	2011-01-16 11:25:46.107999993 +0100
@@ -0,0 +1,19 @@
+policy_module(links, 1.0.0)
+
+############################
+# 
+# Declarations
+#
+
+type links_t;
+type links_exec_t;
+application_domain(links_t, links_exec_t)
+
+type links_home_t;
+typealias links_home_t alias { user_links_home_t staff_links_home_t sysadm_links_home_t };
+userdom_user_home_content(links_home_t)
+
+type links_tmpfs_t;
+typealias links_tmpfs_t alias { user_links_tmpfs_t staff_links_tmpfs_t sysadm_links_tmpfs_t };
+files_tmpfs_file(links_tmpfs_t)
+ubac_constrained(links_tmpfs_t)
--- refpolicy.orig/policy/modules/apps/links.if	1970-01-01 01:00:00.000000000 +0100
+++ refpolicy/policy/modules/apps/links.if	2011-01-16 11:46:01.322000015 +0100
@@ -0,0 +1,86 @@
+## <summary>Links web browser</summary>
+
+#######################################
+## <summary>
+##      The role template for the links module.
+## </summary>
+## <param name="role_prefix">
+##      <summary>
+##      The prefix of the user role (e.g., user
+##      is the prefix for user_r).
+##      </summary>
+## </param>
+## <param name="user_role">
+##      <summary>
+##      The role associated with the user domain.
+##      </summary>
+## </param>
+## <param name="user_domain">
+##      <summary>
+##      The type of the user domain.
+##      </summary>
+## </param>
+#
+template(`links_role_template',`
+	gen_require(`
+		type links_exec_t, links_tmpfs_t, links_home_t;
+	')
+
+	#######################################
+	#
+	# Declarations
+	#
+	
+	type $1_links_t;
+	application_domain($1_links_t, links_exec_t)
+        ubac_constrained($1_links_t)
+
+	role $2 types $1_links_t;
+
+	############################
+	#
+	# Policy
+	#
+
+	allow $1_links_t self:process signal_perms;
+	allow $1_links_t self:unix_stream_socket create_stream_socket_perms;
+
+	manage_dirs_pattern($1_links_t, links_home_t, links_home_t)
+	manage_files_pattern($1_links_t, links_home_t, links_home_t)
+	manage_lnk_files_pattern($1_links_t, links_home_t, links_home_t)
+	manage_sock_files_pattern($1_links_t, links_home_t, links_home_t)
+	manage_fifo_files_pattern($1_links_t, links_home_t, links_home_t)
+	userdom_user_home_dir_filetrans($1_links_t, links_home_t, dir)
+
+	manage_fifo_files_pattern($1_links_t, $1_links_t, $1_links_t)
+
+	manage_dirs_pattern($3, links_home_t, links_home_t)
+	manage_files_pattern($3, links_home_t, links_home_t)
+	manage_lnk_files_pattern($3, links_home_t, links_home_t)
+
+	manage_files_pattern($1_links_t, links_tmpfs_t, links_tmpfs_t)
+	manage_lnk_files_pattern($1_links_t, links_tmpfs_t, links_tmpfs_t)
+	manage_fifo_files_pattern($1_links_t, links_tmpfs_t, links_tmpfs_t)
+	manage_sock_files_pattern($1_links_t, links_tmpfs_t, links_tmpfs_t)
+	fs_tmpfs_filetrans($1_links_t, links_tmpfs_t, { file lnk_file sock_file fifo_file })
+
+	xserver_user_x_domain_template($1_links, $1_links_t, links_tmpfs_t)
+
+	relabel_dirs_pattern($3, links_home_t, links_home_t)
+	relabel_files_pattern($3, links_home_t, links_home_t)
+	relabel_lnk_files_pattern($3, links_home_t, links_home_t)
+
+	domtrans_pattern($3, links_exec_t, $1_links_t)
+
+	ps_process_pattern($3, $1_links_t)
+
+	domain_use_interactive_fds($1_links_t)
+
+        auth_use_nsswitch($1_links_t)
+
+	userdom_use_user_terminals($1_links_t)
+
+	corenet_tcp_connect_http_port($1_links_t)
+
+	miscfiles_read_localization($1_links_t)
+')	
--- refpolicy.orig/policy/modules/apps/links.fc	1970-01-01 01:00:00.000000000 +0100
+++ refpolicy/policy/modules/apps/links.fc	2011-01-16 10:50:48.058999501 +0100
@@ -0,0 +1,2 @@
+/usr/bin/links         -- gen_context(system_u:object_r:links_exec_t,s0)
+HOME_DIR/\.links(/.*)?    gen_context(system_u:object_r:links_home_t,s0)
