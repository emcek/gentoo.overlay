--- refpolicy.orig/policy/modules/admin/portage.te	2010-08-03 15:11:03.000000000 +0200
+++ refpolicy/policy/modules/admin/portage.te	2011-01-07 00:22:03.597999989 +0100
@@ -1,4 +1,4 @@
-policy_module(portage, 1.10.0)
+policy_module(portage, 1.10.0.r1)
 
 ########################################
 #
@@ -274,3 +274,5 @@
 	dontaudit portage_sandbox_t portage_cache_t:dir { setattr };
 	dontaudit portage_sandbox_t portage_cache_t:file { setattr write };
 ')
+
+libs_use_ld_so(portage_sandbox_t)
--- refpolicy.orig/policy/modules/admin/portage.if	2010-08-05 14:46:44.000000000 +0200
+++ refpolicy/policy/modules/admin/portage.if	2011-01-22 13:47:40.623000044 +0100
@@ -77,8 +77,8 @@
 
 	allow $1 self:capability { fowner fsetid mknod setgid setuid chown dac_override net_raw };
 	dontaudit $1 self:capability sys_chroot;
-	allow $1 self:process { setpgid setsched setrlimit signal_perms execmem };
-	allow $1 self:process ~{ ptrace setcurrent setexec setfscreate setrlimit execmem execstack execheap };
+	allow $1 self:process { setpgid setsched setrlimit signal_perms execmem setfscreate };
+	allow $1 self:process ~{ ptrace setcurrent setexec setrlimit execmem execstack execheap };
 	allow $1 self:fd use;
 	allow $1 self:fifo_file rw_fifo_file_perms;
 	allow $1 self:shm create_shm_perms;
